{{ $currentPage := . }}
{{ $storePage := site.GetPage "store" }}
{{ if eq $currentPage $storePage }}
  {{ partial "store/list.html" . }}
{{ else }}
  {{ with .Site.GetPage "store" }}
    {{ $paginator := .Paginate (where site.RegularPages "Section" "store") }}
    {{ range $paginator.Pages }}
      <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
        <div class="block">
          <div class="gallery-overlay">
            <a href="{{ .Permalink }}" class="gallery-popup">
              <i class="tf-ion-plus-round"></i>
            </a>
          </div>
          {{ with first 1 .Params.images }}
            <img class="img-fluid" src="{{.|absURL}}" alt="{{$.Title}}">
          {{ else }}
            <img class="img-fluid" src="/images/placeholder.png" alt="{{$.Title}}">
          {{ end }}
        </div>
        <div class="product-info">
          <h4 class="mb-2"><a href="{{.Permalink}}" class="link-title">{{.Title}}</a></h4>
          <p class="price">{{if .Params.discount_price}}{{site.Params.currency}}{{.Params.discount_price}}{{else}}{{site.Params.currency}}{{.Params.price}}{{end}}
            {{if .Params.discount_price}}<s class="price">{{site.Params.currency}}{{ .Params.price }}</s>{{end}}
          </p>
        </div>
      </div>
    {{ end }}
    {{ partial "pagination.html" . }}
  {{ end }}
{{ end }}
